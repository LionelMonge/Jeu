<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>GameJam - In the matrice</title>
    <script type="text/javascript" src="js/phaser.min.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

<script type="text/javascript">

    var timer =0;

    var game = new Phaser.Game(1280, 720, Phaser.AUTO, 'phaser-example', { preload: preload, create: create, update: update });

    var barre = [];
    var v_barre = [];
    var t_barre = [];

    function preload() {

        //game.load.spritesheet('block', 'pics/block.jpeg',20,20);
        game.load.spritesheet('matrixfont', 'assets/pics/matrix.png', 38, 40, 93);

    }

    function create() {
//        this.game.stage.backgroundColor = '#FFFFFF';
//        for(var l = 0; l < 9; l++) {
//            for(var c = 0; c < 10; c++) {
//                    game.add.sprite((c * 45) + 10, (l * 45) + 10, 'matrixfont', (l * 10) + (c+1));
//            }
//        }



        for(var n=0; n<30; n++) {

            barre[n]=game.add.group();
            t_barre[n] = game.rnd.between(5,30);

            for(var i = 0; i < t_barre[n]; i++) {
                barre[n].create(1, i * 30, 'matrixfont',game.rnd.between(1,80));
            }
            v_barre[n] = 30 * game.rnd.between(1,3);
            barre[n].setAllChildren('tint', '0x008800');
            barre[n].x = 10+(n*38);
            barre[n].y = -t_barre[n];
        }

    }

    function update() {
    timer++;
    if(timer==15) {
        for(var n = 0; n < 30; n++) {
            if (barre[n].y > game.height + (t_barre[n]*30)) {
                barre[n].y = -(t_barre[n]*30);
                //console.log(-t_barre[n]);
                v_barre[n] = 30 * game.rnd.between(1,3);
            }
            barre[n].y += v_barre[n];
        }
        timer=0;
    }
   }

</script>

</body>
</html>